# pptx_generator 要件定義

## 1. 背景と目的
- 社内提案書を短時間で量産し、営業・コンサル部門のドキュメント作成負荷を大幅に軽減する。
- 生成物のビジュアル品質をブランドガイドラインに沿って均一化し、人的手直しを最小限に抑える。
- Mac／Linux／Windows の各環境において同一フローで運用できる自動生成基盤を提供する。

## 2. スコープ
- LLM などから得たアウトライン情報を基に PPTX を生成するサーバー／CLI 実行のワークフロー。
- 生成した PPTX の品質チェックおよび自動補正を含む。
- PDF 化を含むエクスポートと配布の最小手順。
- 監査ログ・通知・設定管理など運用面の要求。

## 3. 利用者とユースケース
- 主利用者: 営業、コンサル、提案資料を扱う社内メンバー。
- 想定ユースケース
  - 夜間に案件情報を投入し、翌朝に提案書を受領。
  - JSON 仕様を渡し、即時に下書き資料を生成してレビュー。
  - 既存資料を基に自動診断レポートを取得し、修正差分を確認。

## 4. 機能要件
1. 入力仕様管理
   - 案件情報を JSON 形式で受け取り、スライド単位のレイアウト・文章・図表・画像設定を含められること。
   - 各スライドの装飾パラメータ（フォント、色、余白、レベルなど）を案件単位で指定できること。
2. PPTX 自動生成
   - 指定テンプレート（.potx 相当）を基に、新規 PPTX を無人で生成すること。
   - 生成内容にタイトル、本文、箇条書き、表、チャート、画像が含められること。
3. 品質診断
   - 生成または既存の PPTX を解析し、余白逸脱、整列不整合、フォントサイズ不足、コントラスト不足、箇条書きの深さなどを検出すること。
   - 検出内容を JSON レポートとして出力し、重大度を付与すること。
4. 自動補正
   - 安全に調整可能な内容（位置スナップ、最小フォント引き上げ、色コントラスト統一、段落レベル制限など）を自動適用できること。
   - 自動補正のオン／オフや対象ルールを設定で制御できること。
5. 出力と配布
   - PPTX を保存し、任意で PDF へ変換できること。
   - 生成ファイルの保存先 URL やメタ情報を通知（Teams/Slack 想定）できること。
6. 監査・ログ
   - 入力 JSON、テEMPLATE バージョン、生成バージョン、ハッシュ値、処理時間などを記録すること。
   - エラー発生時には原因と再実行手順を含むログを残すこと。

## 5. 非機能要件
- パフォーマンス: 30 スライド程度の提案書を 1 分以内に生成できることを目標とする。
- 可用性: 失敗時に再実行できる冪等性とジョブ管理を備えること。
- 拡張性: 追加レイアウトや新たな評価ルールを設定ファイルの変更で反映できること。
- 可観測性: 各ステップの処理時間、失敗率をモニタリングできること。
- 国際化: 日本語フォントを既定としつつ、英語への拡張が可能な構造とすること。
- クロスプラットフォーム: Mac／Linux／Windows で同一コマンドが実行できること。

## 6. 運用要件
- テンプレート・ブランド設定の版管理と適用履歴の把握。
- CI/CD 環境で自動テストおよび自動デプロイを実行可能にすること。
- 定期的なジョブ結果通知とアラート通知を行い、一次対応手順を明文化すること。
- 生成物のストレージ保存期間（初期値 90 日）と削除ポリシーを設定すること。

## 7. セキュリティ・コンプライアンス要件
- 入力データに含まれる機密情報を暗号化保存し、アクセス権限を RBAC で制御すること。
- LLM など外部 API を利用する際は匿名化・マスキングを行い、送信ログを保持すること。
- ライブラリの脆弱性監視を定期実施し、重大な脆弱性は迅速に是正すること。
- アクセスログに利用者 ID、操作内容、タイムスタンプを記録し、監査に対応できること。

## 8. 制約・前提
- オフィスアプリケーションを起動しないヘッドレス実行が前提。
- Python を主要言語とし、補助ツールに .NET を用いる場合はクロスプラットフォーム対応ライブラリに限定する。
- ネットワーク制限下でも基本機能が動作するよう、外部通信は設定で切り替え可能とする。

## 9. 将来拡張要求 (参考)
- Office.js アドインによるワンクリック整形機能の追加。
- LLM を活用したレビューコメント生成や自動校正機能の拡張。
- 既存 PPTX から JSON 仕様を逆生成するリバースエンジニアリング機能。
- 多言語対応、画像生成連携、Keynote/Google Slides 互換出力。

## 10. 未決定事項
- 正式なブランドカラー、フォント、禁則ルールの確定。
- 監査ログ保存基盤の選定と保持期間。
- LLM／視覚モデルのホスティング方式（オンプレミス／クラウド）。
- ジョブ実行プラットフォーム（Azure Functions, Container Apps, AWS Lambda, GCP Cloud Run 等）の最終決定。
- 社員向け配布ポータルの提供方法。
