# 設定・テンプレート管理ポリシー

## 対象範囲
- `config/branding.json`, `config/rules.json` など設定ファイル全般
- `.pptx` テンプレートおよび `rules/polish.yaml`
  ※テンプレートは .pptx のみ対応（.potxは未対応）。.potxを利用したい場合はPowerPointで新規 .pptx として保存してください。

## 変更手順
1. 変更内容を ToDo に記録し、影響範囲を整理する。
2. Pull Request でレビューを受けるまで `draft` 状態を維持する。
3. レビューコメントは 24 時間以内を目安に対応し、議論の結果は PR に明記する。

## バリデーション
- テンプレート更新時は `template_validator.py` を実行し、レイアウト・プレースホルダ構造の差分を確認する。
- 設定ファイルは `jsonschema` に基づく検証スクリプト（未整備の場合は CLI で手動検証）を実施する。

## テンプレート利用要件
- CLI の `--template` オプションで指定できるのは `.pptx` ファイルのみ。.potx は PowerPoint で新規 `.pptx` として保存し直す。
- JSON 仕様の `layout` はテンプレート内のレイアウト名と一致させる。不一致時は既定レイアウトが利用されるため、意図した構成を反映したい場合はテンプレート側の名称を確認する。
- 画像・表・グラフなどを特定位置へ差し込みたい場合は、テンプレートの図形に一意な名前を付けて JSON の `anchor` に同じ名前を記載する。アンカーが無い場合は既定のフォールバック座標に配置される。
- 色やフォントはスライドマスターの設定ではなく `config/branding.json` を参照して適用される。テンプレート側でフォントや配色を変えても自動では反映されない点に注意する。
- 利用者向けテンプレートは `templates/` ディレクトリ配下に管理し、案件固有のテンプレートは `samples/` など任意の場所に置いたうえで CLI 実行時にパスを明示する。

## テンプレート準備チェックリスト
- スライドマスターに JSON 仕様で使用する `layout` と同名のレイアウトを登録し、必要なアウトラインを網羅する。
- 各レイアウトのテキスト枠や図形は位置・サイズを確定させ、不要なプレースホルダーを削除する。
- 差し込み対象の図形・テキスト枠には一意な名前を設定し、JSON から `anchor` として参照できるようにする。
- 配色やフォントは `config/branding.json` が適用する前提で整え、テンプレート側で固定値を埋め込まない。
- 画像・アイコンなど差し替えが想定される領域にはダミー枠を配置し、同じくアンカー名を付与する。
- 想定ストーリー（タイトル、アジェンダ、セクション、まとめ等）に対応したスライド種別が不足していないか確認する。
- `.pptx` 形式で保存し、`soffice` など外部ツールで開いた際に不要なサンプルスライドやメタ情報が残っていないか点検する。

## 追跡と記録
- 重大な意思決定やテンプレート更新理由は `docs/adr/` に記録する。
- リリースノートにはユーザー影響がある設定変更を必ず含める。
- 作業ログは対応した ToDo ファイルに残す。

## ドキュメント更新のチェックリスト

### ToDo 追加時のルール
- `docs/todo/` に新規ファイルを作成したら、必ず当日中に `docs/roadmap/README.md` を更新し、テーマと状況を追記する。
- ロードマップの更新有無はコミット時に確認し、未反映の場合は差し戻す。
- 必要に応じて、ロードマップに「次のアクション」を具体的に記載する。

### 既存ドキュメント更新時のルール
- README やノート類に関わる更新を行った場合は、関連する ToDo にメモや進捗を追記する。
- 設計ノート（`docs/notes/`）は、作業完了時に参照リンクを ToDo メモ欄へ追加する。
- ロードマップの状況欄は「完了項目数 / 総項目数」で管理する。

### レビュー時のチェック観点
- 新しい ToDo がロードマップに未掲載になっていないか。
- ロードマップの状況欄が最新の進捗と一致しているか。
- メモに記されたリンク（ノートや PR）が実在するか。
