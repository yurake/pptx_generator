# 工程1 テンプレ準備 要件詳細

## 概要
- ブランドガイドラインに沿った PPTX テンプレートを整備し、後続工程がメタ情報なしでも利用可能な状態にする。
- テンプレは `/templates/libraries/<brand>/<version>/template.pptx` を基盤とし、レイアウト構造はマスターに準拠させる。
- テンプレ修正作業は人手を前提としつつ、版管理と受け渡しフローは自動化を目指す。

## 入力
- ブランドガイド、既存テンプレート、制約・禁止事項のリスト。
- 新規・改訂テンプレで適用すべきレイアウトカテゴリ（例: タイトル、セクション、KPI、1 カラム、2 カラム）。
- 命名規約（レイアウト名、プレースホルダ名）および必須プレースホルダ種別の標準セット。

## 出力
- テンプレート PPTX（style / master / layout を含む完全版）。
- ビジュアル検証結果（軽微な目視確認ログ）。
- 受け渡しメタ情報: テンプレ名、ブランド、バージョン、作成者、レビュー日、品質サマリ (`summary`)、実行環境情報 (`environment`)。

## ワークフロー
1. レイアウトとスライドマスターの設計・改修方針を策定し、ブランド側の承認を得る。
2. フォント・配色・段落スタイル・図形配置をテンプレに反映する。
3. プレースホルダを配置し、`PH__` 命名規約と必須 PH の整合をチェックする。
4. 図形の直描きを排除し、プレースホルダのみで構成できることを確認する。
5. 目視による崩れ検証を行い、重大な崩れがないことを確認する。
6. ファイル名・配置パスを確定し、工程 2 に受け渡す。

## 品質ゲート
- レイアウトごとに必須 PH が揃っていること（title, body, note 等）。
- プレースホルダ名に重複がないこと。
- マスター階層で不要な図形が残っていないこと。
- テンプレバージョンが `brand_version` 形式で管理されていること。

## 監査・運用
- 受け渡しメタ情報を JSON (仮: `template_release.json`) に記録し、差戻し時は理由を付与する。`summary` でレイアウト/アンカー/警告件数を集計し、`environment` で Python・LibreOffice・.NET SDK のバージョンを記録する。
- 改訂差分はテンプレ版比較レポートとして工程 2 に通知する。
- ゴールデンサンプル PPTX を保存し、互換性テストの基準とする。

## 未実装項目（機能単位）
- テンプレ版比較レポート生成と通知ジョブの実装。
- テンプレ受け渡しメタ (`template_release.json`) の生成 CLI。
- ゴールデンサンプルを生成・検証する自動ジョブ。
