---
目的: レンダラーで表・画像・グラフを描画しブランドスタイルに準拠した PPTX を生成する
担当者: Codex
関連ブランチ: feat/pipeline-enhancements
期限: 2025-10-18
関連Issue: 未設定
---

- [ ] スライド要素の描画戦略を整理し、アンカー解決方針を決める
  - メモ: プレースホルダ名と `SlideImage.anchor` などの対応表をまとめる
- [ ] テンプレート有無での座標フォールバック値を定義する
  - メモ: テンプレート未指定時は Inches ベースで配置する
- [ ] 画像描画処理を実装し、`SlideImage` のサイズ指定とブランド既定値を適用する
  - メモ: `render_images` ヘルパを追加し、ローカルパスと URL 双方に対応する
- [ ] 表描画処理を実装し、ヘッダー色やテキストスタイルをブランド設定から決定する
  - メモ: `TableStyle.header_fill` が未指定の場合は `BrandingConfig.primary_color` を使用する
- [ ] グラフ描画処理を実装し、系列カラーとデータラベル設定を反映する
  - メモ: `ChartSeries.color_hex` が空ならブランドのアクセントカラーを使う
- [ ] `RenderingOptions` を拡張し、`BrandingConfig` を直接参照できるようにする
  - メモ: フォント名や色を個別プロパティではなく構造体で受け渡す
- [ ] ブランド設定由来のフォントをタイトル・本文・表・グラフに適用する
  - メモ: `heading_font` と `body_font` の使い分けを整理する
- [ ] `SimpleRendererStep` をリファクタリングし、新要素の描画ヘルパを分離する
  - メモ: `_apply_tables` `_apply_images` `_apply_charts` を新設
- [ ] サンプル仕様 (`samples/sample_spec.json`) を更新し、画像・表・グラフの組み合わせを追加する
  - メモ: 画像サンプル用のダミーファイルを `samples/assets/` に配置
- [ ] レンダラー単体テストを追加し、新機能の描画ロジックを検証する
  - メモ: `python-pptx` のドキュメントオブジェクトを検査してフォントや色を確認
- [ ] CLI 統合テストを拡張し、生成ファイルに画像・表・グラフが含まれるケースを追加する
  - メモ: 生成された PPTX を一時ディレクトリで確認し、shape 数やテキストを検証
- [ ] `docs/` 配下にレンダラー拡張の設計ノートとテスト結果を記録する
  - メモ: `docs/notes/renderer-rich-content.md` などに経緯と判断を整理
- [ ] `uv run --extra dev pytest` を実行し、追加テストの結果を記録する
  - メモ: 実行ログを ToDo に追記
- [ ] Issue と PR の更新
  - メモ: Issue が未作成のため、作業完了後に番号を確定してコメントとスクリーンショットを添付

## メモ
- `python-pptx` のグラフ描画 API 仕様を確認する資料を収集する
- サンプル画像は CC0 素材を利用する
