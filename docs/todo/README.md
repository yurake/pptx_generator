# ToDo ファイル運用ガイド

## 運用区分
- 大項目の進捗は `docs/roadmap/roadmap.md` にまとめ、開発テーマ単位で状況を共有する。
- このディレクトリでは PR 単位やブランチ単位で実行可能なタスクを管理する。
- 大項目と小項目をリンクさせるため、各ファイルのメタ情報に関連テーマを記入する。
- ToDo ファイルを作業記録の唯一のソースとし、その他のチケット類は参考情報として扱う。

## 作成手順
1. Plan が承認されたら `YYYYMMDD-<slug>.md` 形式で新規ファイルを作成する。コードに影響しない整備タスクでユーザーが ToDo 作成不要と明示した場合は例外的に省略できるが、判断に迷うときはユーザーへ作成要否を問い合わせる。
2. `docs/todo/template.md` をコピーし、目的などのメタ情報に加えて `roadmap_item`（例: `RM-002 エージェント運用ガイド整備`）を必ず記入する。テンプレート内の注意書き（例: 「PR 作成は todo-auto-complete が自動更新するため手動でチェックしない」）は完了確認まで残し、必要なメモのみ追記する。チェック完了時に実績メモへ差し替える。フロントマターの `関連ブランチ` はブランチ作成直後に実名へ更新し、`関連Issue` は `gh issue list --limit 50` などで確認した番号（例: `#165`）に更新する。未作成の場合でも「未作成」と明記し、作成次第必ず差し替える。
3. ロードマップ連動タスクではテンプレートに含まれる「ブランチ→計画→設計→実装→テスト→関連Issue→PR」の工程順を維持し、各チェックボックスに完了条件を具体的に記載する。調査のみで完了する場合は、次の判断主体と判断時期を併記する。
4. メモ欄はタスク本文に収まりきらない背景・リスク・判断メモに限定し、進捗報告はチェックボックスのコメントで行う。

## 更新ルール
- 進捗に応じてチェックボックスを更新し、完了日時や追加メモを残す。テンプレートに記載された「手動更新禁止」の注意書きがある項目（例: PR 作成）は触れず、ワークフローログで結果を確認し、ワークフローが完了した時点で実績メモへ置き換える。PR 作成（ドラフト解除・更新を含む）時に `todo-auto-complete` ワークフローが未完了タスクを検出すると、head ブランチ上で「PR 作成」チェックだけを完了にし、アーカイブ移動とロードマップ更新を自動反映する（その他の未完タスクはそのまま保持される）。
- レビュー時に最新状態を共有できるよう、更新後はコミットに含める。
- 追加の作業依頼や作業内容の修正指示を受けた場合は、作業に着手する前に必ず該当 ToDo を更新し、差分を記録する。
- コミットは細かく分割し、各更新内容が履歴として追跡できるようにする。
- 計画段階で完了と判断した場合も、判断者・判断日・次のアクション条件をメモ欄に追記し、ステータス変更が必要になった時点で再度チェックリストを展開する。
- PR を作成する前に `gh issue list --limit 50` 等で関連 Issue 番号を把握し、ToDo のフロントマター `関連Issue` を最新番号へ更新する。

## アーカイブ
- 作業完了後は `todo-auto-complete` が head ブランチ上で `docs/todo/archive/` へ移動し、ロードマップの該当項目を「完了テーマ」へ移す。
- 自動化対象外のケースでは手動でアーカイブを行い、必要に応じてロードマップの調整方法を `docs/notes/` に残す。
- 手動で移動する際は `git mv docs/todo/<file>.md docs/todo/archive/<file>.md` の形式で `git mv` を使用し、履歴を一貫させる。
